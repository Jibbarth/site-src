<div
    data-controller="debug-bar"
    class="fixed bottom-0 right-0 z-50 font-sans text-[13px] shadow-lg transition-all duration-300 w-auto cursor-pointer"
>
    {# Closed State: Just the Logo #}
    <div
        data-action="click->debug-bar#toggle"
        class="flex items-center justify-center bg-[#222] hover:bg-[#333] transition-colors h-10 px-3"
        title="Click to toggle debug bar"
    >
        <div class="flex items-center gap-2 text-xl">
            {{ ux_icon('fa6-brands:symfony', {class: 'text-gray-300'}) }}
        </div>
    </div>

    {# Expanded Content #}
    <div
        data-debug-bar-target="content"
        class="hidden flex items-center justify-between w-full h-10 bg-[#222] border-t border-[#444] absolute inset-0 pl-2"
    >
         {# Left Section: Scrollable Metrics #}
         <div class="flex items-center h-full overflow-x-auto no-scrollbar">
             {# Status Code / Route #}
             <div class="flex items-center h-full hover:bg-[#333] transition-colors border-r pr-2 border-[#333] whitespace-nowrap cursor-default px-3 gap-2">
                 <span class="bg-[#28a745] text-white px-1.5 py-0.5 rounded-sm font-bold text-[10px]">200</span>
                 <span class="text-[#888]">@</span>
                 <span class="text-white">{{ app.request.attributes.get('_route') ?? 'home' }}</span>
             </div>

             {# Timing #}
             <div class="flex items-center h-full px-3 hover:bg-[#333] transition-colors border-r border-[#333] gap-2 whitespace-nowrap cursor-default">
                 <span class="text-[#888] text-lg">{{ ux_icon('heroicons:clock') }}</span>
                 <span class="text-white font-mono">{{ random(20, 100) }} ms</span>
             </div>

             {# Memory Usage #}
             <div class="flex items-center h-full px-3 hover:bg-[#333] transition-colors border-r border-[#333] gap-2 whitespace-nowrap cursor-default">
                 <span class="text-[#888] text-lg">{{ ux_icon('heroicons:cpu-chip') }}</span>
                 <span class="text-white font-mono">{{ (random(10, 80)/10)|number_format(1) }} MiB</span>
             </div>
         </div>

         {# Right Section: Fixed (Symfony + Close) #}
         <div class="flex items-center h-full border-l border-[#444] bg-[#222] relative z-20">
             {# Symfony Version & Details Trigger #}
            <div class="group relative flex items-center h-full px-3 hover:bg-[#333] transition-colors gap-2 whitespace-nowrap cursor-pointer border-r border-[#444]">
                 <span class="text-[#AAA] hidden text-lg sm:inline">
                     {{ ux_icon('fa6-brands:symfony', {class: 'text-gray-300'}) }}
                 </span>
                 <span class="text-white font-mono">{{ constant('App\\Kernel::VERSION') }}</span>

                 {# Popup Details Card: Aligned to Right #}
                 <div
                    class="hidden group-hover:block absolute bottom-full right-0 w-80 bg-[#222] border border-[#444] shadow-xl text-left cursor-default z-[100] divide-y divide-[#333]"
                    style="font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace;"
                 >
                    {# Header #}
                    <div class="px-3 py-2 bg-[#1f1f1f]">
                         <div class="grid grid-cols-[100px_1fr] gap-2 text-xs">
                             <div class="text-[#888]">Environment</div>
                             <div class="text-[#AAA]">prod</div>
                             <div class="text-[#888]">Debug</div>
                             <div><span class="bg-destructive text-white px-1 py-0.5 text-[10px] uppercase font-bold rounded-sm">disabled</span></div>
                         </div>
                    </div>

                    {# Body #}
                    <div class="px-3 py-2 bg-[#222]">
                        <div class="grid grid-cols-[100px_1fr] gap-2 text-xs">
                            <div class="text-[#888] font-bold">PHP version</div>
                            <div class="text-[#AAA]">{{ constant('PHP_VERSION') }}</div>

                            <div class="text-[#888] font-bold">PHP Extensions</div>
                            <div class="flex flex-wrap gap-2 text-[10px]">
                                <span class="text-[#888] flex items-center gap-0.5">Xdebug {{ ux_icon('heroicons:x-mark', {class: 'w-3 h-3 text-red-500'}) }}</span>
                                <span class="text-[#888] flex items-center gap-0.5">APCu {{ ux_icon('heroicons:x-mark', {class: 'w-3 h-3 text-red-500'}) }}</span>
                                <span class="text-white flex items-center gap-0.5 bg-[#1f6b3b] px-1 rounded-sm">OPcache {{ ux_icon('heroicons:check', {class: 'w-3 h-3 text-white'}) }}</span>
                            </div>

                            <div class="text-[#888] font-bold">PHP SAPI</div>
                            <div class="text-[#AAA]">Static website</div>

                            <div class="text-[#888] font-bold">Server</div>
                            <div class="text-[#AAA]">Github Pages</div>
                        </div>
                    </div>

                     {# Footer #}
                    <div class="px-3 py-2 bg-[#1f1f1f]">
                         <div class="grid grid-cols-[100px_1fr] gap-2 text-xs">
                             <div class="text-[#888] font-bold">Resources</div>
                             <div class="text-[#89a2dd] underline cursor-pointer"><a href="https://github.com/jibbarth/site-src/">Website source</a></div>
                         </div>
                    </div>
                 </div>
            </div>

            {# Close Button #}
            <div data-action="click->debug-bar#toggle" class="h-full flex items-center justify-center px-3 hover:bg-[#444] cursor-pointer text-[#AAA] hover:text-white transition-colors">
                 {{ ux_icon('heroicons:x-mark-16-solid', {class: 'w-4 h-4'}) }}
            </div>
         </div>
    </div>
</div>
